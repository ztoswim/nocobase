{"level":"error","message":"Unable to connect to the database","stack":"Error: Unable to connect to the database\n    at _AsyncEmitter.auth (/app/nocobase/node_modules/@nocobase/database/lib/database.js:641:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async _AsyncEmitter.authenticate (/app/nocobase/node_modules/@nocobase/server/lib/application.js:470:5)\n    at async Object.callback (/app/nocobase/node_modules/@nocobase/server/lib/application.js:797:9)\n    at async _AppCommand.parseAsync (/app/nocobase/node_modules/@nocobase/server/node_modules/commander/lib/command.js:935:5)\n    at async _AsyncEmitter.runAsCLI (/app/nocobase/node_modules/@nocobase/server/lib/application.js:557:23)","meta":{},"module":"application","submodule":"","method":"","app":"main","reqId":"c3fc9975-894b-4258-88b9-0bf6584c82a5","dataSourceKey":"main","timestamp":"2025-05-04 06:35:02"}
{"level":"error","message":"the database system is starting up","stack":"SequelizeConnectionError: the database system is starting up\n    at Client._connectionCallback (/app/nocobase/node_modules/sequelize/lib/dialects/postgres/connection-manager.js:145:24)\n    at Client._handleErrorWhileConnecting (/app/nocobase/node_modules/pg/lib/client.js:336:19)\n    at Client._handleErrorMessage (/app/nocobase/node_modules/pg/lib/client.js:356:19)\n    at Connection.emit (node:events:524:28)\n    at Connection.emit (node:domain:489:12)\n    at /app/nocobase/node_modules/pg/lib/connection.js:116:12\n    at Parser.parse (/app/nocobase/node_modules/pg-protocol/dist/parser.js:36:17)\n    at Socket.<anonymous> (/app/nocobase/node_modules/pg-protocol/dist/index.js:11:42)\n    at Socket.emit (node:events:524:28)\n    at Socket.emit (node:domain:489:12)\n    at addChunk (node:internal/streams/readable:561:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)\n    at Readable.push (node:internal/streams/readable:392:5)\n    at TCP.onStreamRead (node:internal/stream_base_commons:191:23)","app":"main","reqId":"c3fc9975-894b-4258-88b9-0bf6584c82a5","timestamp":"2025-05-04 06:35:02"}
{"level":"error","message":"未认证。请登录以继续。","meta":{"err":"UnauthorizedError: 未认证。请登录以继续。\n    at Object.throw (/app/nocobase/node_modules/koa/lib/context.js:97:11)\n    at BasicAuth.checkToken (/app/nocobase/node_modules/@nocobase/auth/lib/base/auth.js:88:21)\n    at BasicAuth.check (/app/nocobase/node_modules/@nocobase/auth/lib/base/auth.js:193:79)\n    at AuthManagerMiddleware (/app/nocobase/node_modules/@nocobase/auth/lib/auth-manager.js:121:35)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async validateFilterParams (/app/nocobase/node_modules/@nocobase/server/lib/middlewares/validate-filter-params.js:39:12)\n    at async /app/nocobase/node_modules/@nocobase/plugin-users/dist/server/server.js:223:7\n    at async deleteRolesCache (/app/nocobase/node_modules/@nocobase/plugin-users/dist/server/server.js:212:7)\n    at async app.resourcer.use.before (/app/nocobase/node_modules/@nocobase/plugin-file-manager/dist/server/actions/index.js:55:7)\n    at async handleFieldSourceMiddleware (/app/nocobase/node_modules/@nocobase/plugin-data-source-main/dist/server/server.js:443:7)\n    at async mergeReverseFieldWhenSaveCollectionField (/app/nocobase/node_modules/@nocobase/plugin-data-source-main/dist/server/server.js:417:7)\n    at async pushUISchemaWhenUpdateCollectionField (/app/nocobase/node_modules/@nocobase/plugin-data-source-main/dist/server/server.js:349:7)\n    at async pushUISchemaWhenUpdateCollectionField (/app/nocobase/node_modules/@nocobase/plugin-data-source-main/dist/server/server.js:330:7)\n    at async appendDataToRolesCheck (/app/nocobase/node_modules/@nocobase/plugin-data-source-manager/dist/server/plugin.js:593:7)\n    at async setDataSourceListDefaultSort (/app/nocobase/node_modules/@nocobase/plugin-data-source-manager/dist/server/plugin.js:310:7)\n    at async showAnonymous (/app/nocobase/node_modules/@nocobase/plugin-acl/dist/server/server.js:459:7)"},"module":"desktopRoutes","submodule":"listAccessible","method":"error-handler","app":"main","reqId":"10de1f43-5f0f-4591-8a94-f908ab823b9e","dataSourceKey":"main","timestamp":"2025-05-04 06:38:04"}
{"level":"error","message":"未认证。请登录以继续。","meta":{"err":"UnauthorizedError: 未认证。请登录以继续。\n    at Object.throw (/app/nocobase/node_modules/koa/lib/context.js:97:11)\n    at BasicAuth.checkToken (/app/nocobase/node_modules/@nocobase/auth/lib/base/auth.js:88:21)\n    at BasicAuth.check (/app/nocobase/node_modules/@nocobase/auth/lib/base/auth.js:193:79)\n    at AuthManagerMiddleware (/app/nocobase/node_modules/@nocobase/auth/lib/auth-manager.js:121:35)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async validateFilterParams (/app/nocobase/node_modules/@nocobase/server/lib/middlewares/validate-filter-params.js:39:12)\n    at async /app/nocobase/node_modules/@nocobase/plugin-users/dist/server/server.js:223:7\n    at async deleteRolesCache (/app/nocobase/node_modules/@nocobase/plugin-users/dist/server/server.js:212:7)\n    at async app.resourcer.use.before (/app/nocobase/node_modules/@nocobase/plugin-file-manager/dist/server/actions/index.js:55:7)\n    at async handleFieldSourceMiddleware (/app/nocobase/node_modules/@nocobase/plugin-data-source-main/dist/server/server.js:443:7)\n    at async mergeReverseFieldWhenSaveCollectionField (/app/nocobase/node_modules/@nocobase/plugin-data-source-main/dist/server/server.js:417:7)\n    at async pushUISchemaWhenUpdateCollectionField (/app/nocobase/node_modules/@nocobase/plugin-data-source-main/dist/server/server.js:349:7)\n    at async pushUISchemaWhenUpdateCollectionField (/app/nocobase/node_modules/@nocobase/plugin-data-source-main/dist/server/server.js:330:7)\n    at async appendDataToRolesCheck (/app/nocobase/node_modules/@nocobase/plugin-data-source-manager/dist/server/plugin.js:593:7)\n    at async setDataSourceListDefaultSort (/app/nocobase/node_modules/@nocobase/plugin-data-source-manager/dist/server/plugin.js:310:7)\n    at async showAnonymous (/app/nocobase/node_modules/@nocobase/plugin-acl/dist/server/server.js:459:7)"},"module":"desktopRoutes","submodule":"listAccessible","method":"error-handler","app":"main","reqId":"14b8a88e-8f59-4b2e-94ad-9d5ea3585ef3","dataSourceKey":"main","timestamp":"2025-05-04 06:38:04"}
{"level":"error","message":"column student.undefined does not exist","meta":{"err":"Error\n    at Query.run (/app/nocobase/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)\n    at /app/nocobase/node_modules/sequelize/lib/sequelize.js:315:28\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async PostgresQueryInterface.select (/app/nocobase/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)\n    at async student.findAll (/app/nocobase/node_modules/sequelize/lib/model.js:1140:21)\n    at async queryData (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:82:16)\n    at async /app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/query-parser/query-parser.js:139:7\n    at async parseFieldAndAssociations (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:189:3)\n    at async /app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:196:5\n    at async Object.parseVariables (/app/nocobase/node_modules/@nocobase/server/lib/middlewares/parse-variables.js:88:3)\n    at async parseVariables (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:194:3)\n    at async cacheMiddleware (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:210:3)\n    at async query (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:231:5)\n    at async triggerWorkflowActionMiddleware (/app/nocobase/node_modules/@nocobase/plugin-workflow-action-trigger/dist/server/ActionTrigger.js:61:7)\n    at async dataTemplate (/app/nocobase/node_modules/@nocobase/server/lib/middlewares/data-template.js:36:3)\n    at async app.acl.use.after (/app/nocobase/node_modules/@nocobase/plugin-acl/dist/server/server.js:534:9)"},"module":"charts","submodule":"query","method":"error-handler","app":"main","reqId":"e7974dfc-a53f-455b-8d46-e5497db582b5","dataSourceKey":"main","timestamp":"2025-05-04 06:49:06"}
{"level":"error","message":"column student.undefined does not exist","meta":{"err":"Error\n    at Query.run (/app/nocobase/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)\n    at /app/nocobase/node_modules/sequelize/lib/sequelize.js:315:28\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async PostgresQueryInterface.select (/app/nocobase/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)\n    at async student.findAll (/app/nocobase/node_modules/sequelize/lib/model.js:1140:21)\n    at async queryData (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:82:16)\n    at async /app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/query-parser/query-parser.js:139:7\n    at async parseFieldAndAssociations (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:189:3)\n    at async /app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:196:5\n    at async Object.parseVariables (/app/nocobase/node_modules/@nocobase/server/lib/middlewares/parse-variables.js:88:3)\n    at async parseVariables (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:194:3)\n    at async cacheMiddleware (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:210:3)\n    at async query (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:231:5)\n    at async triggerWorkflowActionMiddleware (/app/nocobase/node_modules/@nocobase/plugin-workflow-action-trigger/dist/server/ActionTrigger.js:61:7)\n    at async dataTemplate (/app/nocobase/node_modules/@nocobase/server/lib/middlewares/data-template.js:36:3)\n    at async app.acl.use.after (/app/nocobase/node_modules/@nocobase/plugin-acl/dist/server/server.js:534:9)"},"module":"charts","submodule":"query","method":"error-handler","app":"main","reqId":"a34bf197-084f-4f18-b98f-9648756b9036","dataSourceKey":"main","timestamp":"2025-05-04 06:49:37"}
{"level":"error","message":"function sum(character varying) does not exist","meta":{"err":"Error\n    at Query.run (/app/nocobase/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)\n    at /app/nocobase/node_modules/sequelize/lib/sequelize.js:315:28\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async PostgresQueryInterface.select (/app/nocobase/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)\n    at async create_course.findAll (/app/nocobase/node_modules/sequelize/lib/model.js:1140:21)\n    at async queryData (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:82:16)\n    at async /app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/query-parser/query-parser.js:139:7\n    at async parseFieldAndAssociations (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:189:3)\n    at async /app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:196:5\n    at async parseVariables (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:194:3)\n    at async cacheMiddleware (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:210:3)\n    at async query (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:231:5)\n    at async triggerWorkflowActionMiddleware (/app/nocobase/node_modules/@nocobase/plugin-workflow-action-trigger/dist/server/ActionTrigger.js:61:7)\n    at async dataTemplate (/app/nocobase/node_modules/@nocobase/server/lib/middlewares/data-template.js:36:3)\n    at async app.acl.use.after (/app/nocobase/node_modules/@nocobase/plugin-acl/dist/server/server.js:534:9)\n    at async middlewares.add.tag (/app/nocobase/node_modules/@nocobase/acl/lib/acl.js:398:9)"},"module":"charts","submodule":"query","method":"error-handler","app":"main","reqId":"f2599c06-c91d-4ad9-b105-8a28b960f667","dataSourceKey":"main","timestamp":"2025-05-04 06:54:39"}
{"level":"error","message":"function avg(character varying) does not exist","meta":{"err":"Error\n    at Query.run (/app/nocobase/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)\n    at /app/nocobase/node_modules/sequelize/lib/sequelize.js:315:28\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async PostgresQueryInterface.select (/app/nocobase/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)\n    at async create_course.findAll (/app/nocobase/node_modules/sequelize/lib/model.js:1140:21)\n    at async queryData (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:82:16)\n    at async /app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/query-parser/query-parser.js:139:7\n    at async parseFieldAndAssociations (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:189:3)\n    at async /app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:196:5\n    at async parseVariables (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:194:3)\n    at async cacheMiddleware (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:210:3)\n    at async query (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:231:5)\n    at async triggerWorkflowActionMiddleware (/app/nocobase/node_modules/@nocobase/plugin-workflow-action-trigger/dist/server/ActionTrigger.js:61:7)\n    at async dataTemplate (/app/nocobase/node_modules/@nocobase/server/lib/middlewares/data-template.js:36:3)\n    at async app.acl.use.after (/app/nocobase/node_modules/@nocobase/plugin-acl/dist/server/server.js:534:9)\n    at async middlewares.add.tag (/app/nocobase/node_modules/@nocobase/acl/lib/acl.js:398:9)"},"module":"charts","submodule":"query","method":"error-handler","app":"main","reqId":"76e4ad86-2904-4854-a183-98a8b22ac9b3","dataSourceKey":"main","timestamp":"2025-05-04 06:54:44"}
{"level":"error","message":"column student.undefined does not exist","meta":{"err":"Error\n    at Query.run (/app/nocobase/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)\n    at /app/nocobase/node_modules/sequelize/lib/sequelize.js:315:28\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async PostgresQueryInterface.select (/app/nocobase/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)\n    at async student.findAll (/app/nocobase/node_modules/sequelize/lib/model.js:1140:21)\n    at async queryData (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:82:16)\n    at async /app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/query-parser/query-parser.js:139:7\n    at async parseFieldAndAssociations (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:189:3)\n    at async /app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:196:5\n    at async Object.parseVariables (/app/nocobase/node_modules/@nocobase/server/lib/middlewares/parse-variables.js:88:3)\n    at async parseVariables (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:194:3)\n    at async cacheMiddleware (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:210:3)\n    at async query (/app/nocobase/node_modules/@nocobase/plugin-data-visualization/dist/server/actions/query.js:231:5)\n    at async triggerWorkflowActionMiddleware (/app/nocobase/node_modules/@nocobase/plugin-workflow-action-trigger/dist/server/ActionTrigger.js:61:7)\n    at async dataTemplate (/app/nocobase/node_modules/@nocobase/server/lib/middlewares/data-template.js:36:3)\n    at async app.acl.use.after (/app/nocobase/node_modules/@nocobase/plugin-acl/dist/server/server.js:534:9)"},"module":"charts","submodule":"query","method":"error-handler","app":"main","reqId":"6186a0b2-46f1-4817-a5f8-9f937e0a5446","dataSourceKey":"main","timestamp":"2025-05-04 07:07:53"}
{"level":"error","message":"column package.name_sort does not exist","meta":{"err":"Error\n    at Query.run (/app/nocobase/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)\n    at /app/nocobase/node_modules/sequelize/lib/sequelize.js:315:28\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async PostgresQueryInterface.select (/app/nocobase/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)\n    at async package.findAll (/app/nocobase/node_modules/sequelize/lib/model.js:1140:21)\n    at async _Repository.find (/app/nocobase/node_modules/@nocobase/database/lib/repository.js:261:14)\n    at async listWithNonPaged (/app/nocobase/node_modules/@nocobase/actions/lib/actions/list.js:89:16)\n    at async list (/app/nocobase/node_modules/@nocobase/actions/lib/actions/list.js:96:5)\n    at async triggerWorkflowActionMiddleware (/app/nocobase/node_modules/@nocobase/plugin-workflow-action-trigger/dist/server/ActionTrigger.js:61:7)\n    at async dataTemplate (/app/nocobase/node_modules/@nocobase/server/lib/middlewares/data-template.js:36:3)\n    at async parseVariables (/app/nocobase/node_modules/@nocobase/server/lib/middlewares/parse-variables.js:88:3)\n    at async app.acl.use.after (/app/nocobase/node_modules/@nocobase/plugin-acl/dist/server/server.js:534:9)\n    at async middlewares.add.tag (/app/nocobase/node_modules/@nocobase/acl/lib/acl.js:398:9)\n    at async /app/nocobase/node_modules/@nocobase/acl/lib/allow-manager.js:108:7\n    at async ACLMiddleware (/app/nocobase/node_modules/@nocobase/acl/lib/acl.js:288:14)\n    at async app.resourcer.use.group (/app/nocobase/node_modules/@nocobase/plugin-api-keys/dist/server/plugin.js:62:9)"},"module":"package","submodule":"list","method":"error-handler","app":"main","reqId":"00f41ed5-3deb-4c3b-b632-b4a204709b1b","dataSourceKey":"main","timestamp":"2025-05-04 07:41:09"}
{"level":"error","message":"Cannot read properties of null (reading 'set')","meta":{"err":"TypeError: Cannot read properties of null (reading 'set')\n    at _UiSchemaRepository.patch (/app/nocobase/node_modules/@nocobase/plugin-ui-schema-storage/dist/server/repository.js:263:9)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async descriptor.value (/app/nocobase/node_modules/@nocobase/plugin-ui-schema-storage/dist/server/repository.js:82:16)\n    at async _UiSchemaRepository.batchPatch (/app/nocobase/node_modules/@nocobase/plugin-ui-schema-storage/dist/server/repository.js:304:7)\n    at async descriptor.value (/app/nocobase/node_modules/@nocobase/plugin-ui-schema-storage/dist/server/repository.js:74:27)\n    at async /app/nocobase/node_modules/@nocobase/plugin-ui-schema-storage/dist/server/actions/ui-schema-action.js:53:25\n    at async triggerWorkflowActionMiddleware (/app/nocobase/node_modules/@nocobase/plugin-workflow-action-trigger/dist/server/ActionTrigger.js:61:7)\n    at async dataTemplate (/app/nocobase/node_modules/@nocobase/server/lib/middlewares/data-template.js:36:3)\n    at async app.acl.use.after (/app/nocobase/node_modules/@nocobase/plugin-acl/dist/server/server.js:534:9)\n    at async middlewares.add.tag (/app/nocobase/node_modules/@nocobase/acl/lib/acl.js:398:9)\n    at async /app/nocobase/node_modules/@nocobase/acl/lib/allow-manager.js:108:7\n    at async ACLMiddleware (/app/nocobase/node_modules/@nocobase/acl/lib/acl.js:288:14)\n    at async app.resourcer.use.group (/app/nocobase/node_modules/@nocobase/plugin-api-keys/dist/server/plugin.js:62:9)\n    at async setCurrentRole (/app/nocobase/node_modules/@nocobase/plugin-acl/dist/server/middlewares/setCurrentRole.js:87:3)\n    at async AuthManagerMiddleware (/app/nocobase/node_modules/@nocobase/auth/lib/auth-manager.js:125:7)\n    at async validateFilterParams (/app/nocobase/node_modules/@nocobase/server/lib/middlewares/validate-filter-params.js:39:12)"},"module":"uiSchemas","submodule":"batchPatch","method":"error-handler","app":"main","reqId":"6cc6e89b-2628-4ddc-b66c-0729db79cbde","dataSourceKey":"main","timestamp":"2025-05-04 07:58:46"}
